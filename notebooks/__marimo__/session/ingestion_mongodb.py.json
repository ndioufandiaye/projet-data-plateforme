{
  "version": "1",
  "metadata": {
    "marimo_version": "0.20.2"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "d28a58a52f80853927236314bd44991d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "6ef0826a5a2f6bd489909601ddc94730",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "ccd616602283b618595ea500d950d095",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "R\u00e9ussi ! 48 employ\u00e9s import\u00e9s avec succ\u00e8s.\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "bkHC",
      "code_hash": "f0d33f7eb1682c8ef6125dbe88da6a28",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r[Stage 0:>                                                          (0 + 0) / 1]\r\r[Stage 0:>                                                          (0 + 1) / 1]\r\r[Stage 0:===========================================================(1 + 0) / 1]\r\r[Stage 2:>                                                          (0 + 1) / 1]\r\r                                                                                \r",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Succ\u00e8s ! Spark a trouv\u00e9 48 documents.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r[Stage 3:>                                                          (0 + 1) / 1]\r\r                                                                                \r",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "+--------------------+--------------------+----------+------+----------+-----+---------+\n|                 _id|             adresse|anciennete|   nom|    prenom|prime|      tel|\n+--------------------+--------------------+----------+------+----------+-----+---------+\n|511d0a9f181b16509...|{31000, 77, NULL,...|        10|Dupond|      Jean| NULL|     NULL|\n|511d0a9f181b16509...|{33000, 78, NULL,...|        27|  King|     David| NULL|     NULL|\n|511d0a9f181b16509...|{75000, 75, NULL,...|         7|Ossola|Christophe| NULL|     NULL|\n|511d0a9f181b16509...|{31000, 80, Gener...|         2|Monnin|    Gilles| NULL|     NULL|\n|511d0a9f181b16509...|{9500, 79, NULL, ...|         5| Priou|    Franck| NULL|547608352|\n+--------------------+--------------------+----------+------+----------+-----+---------+\nonly showing top 5 rows\n\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "lEQa",
      "code_hash": "51064d899de53434c35c55c9f5c0977c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": ":: loading settings :: url = jar:file:/usr/local/lib/python3.11/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "Ivy Default Cache set to: /root/.ivy2/cache\nThe jars for the packages stored in: /root/.ivy2/jars\norg.mongodb.spark#mongo-spark-connector_2.12 added as a dependency\norg.apache.hadoop#hadoop-aws added as a dependency\n:: resolving dependencies :: org.apache.spark#spark-submit-parent-8453e805-6e84-4587-9ea6-54e14ce353b3;1.0\n\tconfs: [default]\n\tfound org.mongodb.spark#mongo-spark-connector_2.12;10.4.0 in central\n\tfound org.mongodb#mongodb-driver-sync;5.1.4 in central\n\t[5.1.4] org.mongodb#mongodb-driver-sync;[5.1.1,5.1.99)\n\tfound org.mongodb#bson;5.1.4 in central\n\tfound org.mongodb#mongodb-driver-core;5.1.4 in central\n\tfound org.mongodb#bson-record-codec;5.1.4 in central\n\tfound org.apache.hadoop#hadoop-aws;3.3.4 in central\n\tfound com.amazonaws#aws-java-sdk-bundle;1.12.262 in central\n\tfound org.wildfly.openssl#wildfly-openssl;1.0.7.Final in central\n:: resolution report :: resolve 6340ms :: artifacts dl 111ms\n\t:: modules in use:\n\tcom.amazonaws#aws-java-sdk-bundle;1.12.262 from central in [default]\n\torg.apache.hadoop#hadoop-aws;3.3.4 from central in [default]\n\torg.mongodb#bson;5.1.4 from central in [default]\n\torg.mongodb#bson-record-codec;5.1.4 from central in [default]\n\torg.mongodb#mongodb-driver-core;5.1.4 from central in [default]\n\torg.mongodb#mongodb-driver-sync;5.1.4 from central in [default]\n\torg.mongodb.spark#mongo-spark-connector_2.12;10.4.0 from central in [default]\n\torg.wildfly.openssl#wildfly-openssl;1.0.7.Final from central in [default]\n\t---------------------------------------------------------------------\n\t|                  |            modules            ||   artifacts   |\n\t|       conf       | number| search|dwnlded|evicted|| number|dwnlded|\n\t---------------------------------------------------------------------\n\t|      default     |   8   |   1   |   0   |   0   ||   8   |   0   |\n\t---------------------------------------------------------------------\n:: retrieving :: org.apache.spark#spark-submit-parent-8453e805-6e84-4587-9ea6-54e14ce353b3\n\tconfs: [default]\n\t0 artifacts copied, 8 already retrieved (0kB/99ms)\n26/03/01 15:20:47 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nSetting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n26/03/01 15:21:05 WARN GarbageCollectionMetrics: To enable non-built-in garbage collector(s) List(G1 Concurrent GC), users should configure it(them) to spark.eventLog.gcMetrics.youngGenerationGarbageCollectors or spark.eventLog.gcMetrics.oldGenerationGarbageCollectors\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "PKri",
      "code_hash": "7b170132465e60af9d1f74bd45d04d0b",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Envoi de 48 lignes vers MinIO...\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "26/03/01 15:21:58 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties\n\r[Stage 10:>                                                         (0 + 1) / 1]\r\r                                                                                \r",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": " Ingestion termin\u00e9e : s3a://bronze/mongodb/employes/20260301_1521/\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "Xref",
      "code_hash": "519484cc1ec968532c3de9dbcc71d0cc",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\ud83d\udce4 Envoi vers MinIO...\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r[Stage 14:>                                                         (0 + 1) / 1]\r\r                                                                                \r",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Ingestion termin\u00e9e dans : s3a://bronze/mongodb/employes/donnees_finales/\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "SFPL",
      "code_hash": "978c6323855250206e0d65e0c83e101c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Lecture r\u00e9ussie ! Total : 48 employ\u00e9s.\n+--------------------+--------------------+----------+------+----------+-----+---------+\n|                 _id|             adresse|anciennete|   nom|    prenom|prime|      tel|\n+--------------------+--------------------+----------+------+----------+-----+---------+\n|511d0a9f181b16509...|{31000, 77, NULL,...|        10|Dupond|      Jean| NULL|     NULL|\n|511d0a9f181b16509...|{33000, 78, NULL,...|        27|  King|     David| NULL|     NULL|\n|511d0a9f181b16509...|{75000, 75, NULL,...|         7|Ossola|Christophe| NULL|     NULL|\n|511d0a9f181b16509...|{31000, 80, Gener...|         2|Monnin|    Gilles| NULL|     NULL|\n|511d0a9f181b16509...|{9500, 79, NULL, ...|         5| Priou|    Franck| NULL|547608352|\n+--------------------+--------------------+----------+------+----------+-----+---------+\nonly showing top 5 rows\n\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "BYtC",
      "code_hash": "fcb22c1db1f109705b27f2d708d88016",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "RGSE",
      "code_hash": "b43e771fa2b2519eb0efcabdef285bd3",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\u2728 Donn\u00e9es transform\u00e9es en format Silver :\n+------+----------+----------+----------+--------+-----+-----+\n|   nom|    prenom|anciennete|rue_numero|   ville|   cp|prime|\n+------+----------+----------+----------+--------+-----+-----+\n|Dupond|      Jean|        10|        77|Toulouse|31000|  0.0|\n|  King|     David|        27|        78|Bordeaux|33000|  0.0|\n|Ossola|Christophe|         7|        75|   Paris|75000|  0.0|\n|Monnin|    Gilles|         2|        80|Toulouse|31000|  0.0|\n| Priou|    Franck|         5|        79|    Foix| 9500|  0.0|\n+------+----------+----------+----------+--------+-----+-----+\nonly showing top 5 rows\n\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "Kclp",
      "code_hash": "b72969102e2a6944286946f0278edbf7",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r[Stage 23:>                                                         (0 + 1) / 1]\r\r                                                                                \r",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "\ud83d\ude80 Couche Silver mise \u00e0 jour avec succ\u00e8s dans : s3a://silver/mongodb/employes/clean_data/\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "emfo",
      "code_hash": "bef1518594b5b902da3eb4c3cb410b4b",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hstk",
      "code_hash": "0de2a502a842f1ccf53c85da10e0d82f",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\ud83c\udfc6 Couche GOLD : Statistiques RH par ville\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r[Stage 25:>                                                         (0 + 1) / 1]\r\r[Stage 27:>                                                         (0 + 1) / 1]\r\r                                                                                \r",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "+--------+---------------+------------------+------------+\n|   ville|nombre_employes|anciennete_moyenne|total_primes|\n+--------+---------------+------------------+------------+\n|Toulouse|             16|               7.6|         0.0|\n|    Foix|             16|               5.2|     25200.0|\n|   Paris|              8|               7.1|         0.0|\n|Bordeaux|              8|              17.5|         0.0|\n+--------+---------------+------------------+------------+\n\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "nWHF",
      "code_hash": "58f164fa3f574b79e04207f7ae578faf",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r[Stage 35:>                                                         (0 + 1) / 1]\r\r                                                                                \r",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "\ud83e\udd47 Couche GOLD g\u00e9n\u00e9r\u00e9e avec succ\u00e8s : s3a://gold/mongodb/stats_rh_villes/\n",
          "mimetype": "text/plain"
        }
      ]
    }
  ]
}